---
/**
 * Tabs List Page
 *
 * @description Displays all guitar tabs.
 *
 * @route /tabs
 */

import { Icon } from 'astro-icon/components';
import MainGridLayout from '@layouts/MainGridLayout.astro';
import TabCard from '@components/card/TabCard.astro';
import { getSortedTabs } from '@utils/content-utils';
import { i18n, I18nKey } from '@i18n/index';

// Get all tabs sorted by date
const tabs = await getSortedTabs();

// Group tabs by difficulty
const tabsByDifficulty = {
  beginner: tabs.filter((t) => t.data.difficulty === 'beginner'),
  intermediate: tabs.filter((t) => t.data.difficulty === 'intermediate'),
  advanced: tabs.filter((t) => t.data.difficulty === 'advanced'),
  expert: tabs.filter((t) => t.data.difficulty === 'expert'),
};
---

<MainGridLayout title={i18n(I18nKey.tabs)} description="Guitar tabs and lessons" hideSidebar={true}>
  <div class="mx-auto max-w-4xl space-y-8">
    <!-- Page Header -->
    <header class="text-center">
      <h1 class="flex items-center justify-center gap-3 text-3xl font-bold text-[var(--text-primary)] md:text-4xl">
        <Icon name="material-symbols:music-note" class="h-8 w-8" />
        {i18n(I18nKey.tabs)}
      </h1>
      <p class="mt-2 text-[var(--text-secondary)]">
        Guitar tabs, lessons, and tutorials
      </p>
    </header>

    <!-- Tabs by Difficulty -->
    {
      tabs.length > 0 ? (
        <div class="space-y-8">
          {Object.entries(tabsByDifficulty).map(([difficulty, difficultyTabs]) => {
            if (difficultyTabs.length === 0) return null;

            return (
              <section>
                <h2 class="mb-4 text-xl font-bold capitalize text-[var(--text-primary)]">
                  {difficulty}
                  <span class="ml-2 text-sm font-normal text-[var(--text-tertiary)]">
                    ({difficultyTabs.length} tabs)
                  </span>
                </h2>
                <div class="grid gap-4 md:grid-cols-2">
                  {difficultyTabs.map((tab) => (
                    <TabCard tab={tab} />
                  ))}
                </div>
              </section>
            );
          })}
        </div>
      ) : (
        <div class="rounded-xl bg-[var(--card-bg)] p-8 text-center">
          <Icon
            name="material-symbols:music-off-outline"
            class="mx-auto mb-4 h-12 w-12 text-[var(--text-tertiary)]"
          />
          <p class="text-[var(--text-secondary)]">No tabs yet. Check back soon!</p>
        </div>
      )
    }
  </div>
</MainGridLayout>
