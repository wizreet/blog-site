---
/**
 * Categories Widget Component
 *
 * @description Displays a list of post categories in the sidebar.
 * Shows category name and post count.
 */

import { Icon } from 'astro-icon/components';
import { getCategories } from '@utils/content-utils';
import { i18n, I18nKey } from '@i18n/index';

// Get categories with counts
const categories = await getCategories();

// Sort by count (descending)
const sortedCategories = categories.sort((a, b) => b.count - a.count);

// Limit to top categories for sidebar
const displayCategories = sortedCategories.slice(0, 8);
---

<div class="card-base p-4">
  <!-- Header -->
  <h3 class="mb-3 flex items-center gap-2 text-sm font-semibold uppercase tracking-wider text-[var(--text-secondary)]">
    <Icon name="material-symbols:folder-outline" class="h-4 w-4" />
    {i18n(I18nKey.categories)}
  </h3>

  <!-- Categories List -->
  {
    displayCategories.length > 0 ? (
      <ul class="space-y-1">
        {displayCategories.map((category) => (
          <li>
            <div
              class="flex items-center justify-between rounded-md px-2 py-1.5 text-sm"
            >
              <span class="text-[var(--text-primary)]">{category.name}</span>
              <span class="rounded-full bg-[var(--btn-regular-bg)] px-2 py-0.5 text-xs text-[var(--text-tertiary)]">
                {category.count}
              </span>
            </div>
          </li>
        ))}
      </ul>
    ) : (
      <p class="text-sm text-[var(--text-tertiary)]">No categories yet</p>
    )
  }
</div>
