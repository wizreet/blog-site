---
/**
 * Video Card Component
 *
 * @description A card component for displaying a hidden music video.
 * Used in the hidden /music/ page.
 */

import { Icon } from 'astro-icon/components';
import type { CollectionEntry } from 'astro:content';
import { formatDate } from '@utils/date-utils';

interface Props {
  /** The music entry from content collection */
  video: CollectionEntry<'music'>;
}

const { video } = Astro.props;

const { title, artist, youtubeId, published, notes } = video.data;

// YouTube thumbnail URL
const thumbnailUrl = youtubeId
  ? `https://img.youtube.com/vi/${youtubeId}/mqdefault.jpg`
  : null;
---

<article class="card-base group overflow-hidden">
  <!-- Thumbnail -->
  {
    thumbnailUrl && (
      <div class="relative aspect-video overflow-hidden">
        <img
          src={thumbnailUrl}
          alt={title}
          class="h-full w-full object-cover transition-transform duration-300 group-hover:scale-105"
          loading="lazy"
        />
        {/* Play Overlay */}
        <div class="absolute inset-0 flex items-center justify-center bg-black/30 opacity-0 transition-opacity duration-300 group-hover:opacity-100">
          <div class="flex h-14 w-14 items-center justify-center rounded-full bg-white/90 text-red-600">
            <Icon name="material-symbols:play-arrow" class="h-8 w-8" />
          </div>
        </div>
      </div>
    )
  }

  <!-- Content -->
  <div class="p-4">
    <!-- Title -->
    <h3 class="font-bold text-[var(--text-primary)] transition-colors group-hover:text-[oklch(var(--primary))]">
      {title}
    </h3>

    <!-- Artist -->
    {
      artist && (
        <p class="mt-1 text-sm text-[var(--text-secondary)]">
          {artist}
        </p>
      )
    }

    <!-- Notes -->
    {
      notes && (
        <p class="mt-2 line-clamp-2 text-xs text-[var(--text-tertiary)]">
          {notes}
        </p>
      )
    }

    <!-- Meta -->
    <div class="mt-3 flex items-center gap-2 text-xs text-[var(--text-tertiary)]">
      <Icon name="material-symbols:calendar-today-outline" class="h-3.5 w-3.5" />
      <time datetime={published.toISOString()}>
        {formatDate(published)}
      </time>
    </div>
  </div>

  <!-- Click to open in modal (handled by parent) -->
  <button
    class="absolute inset-0 cursor-pointer"
    data-video-id={youtubeId}
    data-video-title={title}
    aria-label={`Play ${title}`}
  >
  </button>
</article>
